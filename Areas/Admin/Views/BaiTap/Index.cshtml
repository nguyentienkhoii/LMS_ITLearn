@using X.PagedList.Mvc.Core;
@using X.PagedList.Web.Common;
@using X.PagedList;
@model IPagedList<WebBaiGiang_CKC.Models.BaiTap>

@{
    ViewData["Title"] = "Quản lý bài tập";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAdmin.cshtml";
}

<ol class="breadcrumb">
    <li class="breadcrumb-item"><a asp-controller="Home" asp-action="Index">Trang chủ</a></li>
    <li class="breadcrumb-item active">Quản lý bài tập</li>
</ol>

<h1 class="text-center">QUẢN LÝ BÀI TẬP</h1>
<hr />
<br />
<form method="get" class="row mb-3">
    <div class="col-md-4">
        <select name="lopId" class="form-select">
            <option value="">-- Tất cả lớp học --</option>

            @foreach (var lop in ViewBag.LopList)
            {
                <option value="@lop.MaLopHoc"
                        selected="@(ViewBag.SelectedLop == lop.MaLopHoc ? "selected" : null)">
                    @lop.TenLopHoc
                </option>

            }
        </select>
    </div>

    <div class="col-md-2">
        <button class="btn btn-primary w-100" type="submit">Lọc</button>
    </div>

    <div class="col-md-2">
        <a href="@Url.Action("Index")" class="btn btn-secondary w-100">Xóa lọc</a>
    </div>
</form>

<a asp-action="Create" class="btn btn-success mb-2">Thêm</a>

<table class="table table alert-light">
    <thead class="table-dark">
        <tr class="text-center">
            <th>Chương</th>
            <th>Bài</th>
            <th>Tên bài tập</th>
            <th>Hạn nộp</th>
            <th>Nộp muộn đến</th>
            <th></th>
        </tr>
    </thead>

    <tbody class="text-center">
        @foreach (var item in Model)
        {
            <tr>
                <td>@item.Bai?.Chuong?.TenChuong</td>
                <td>@item.Bai?.TenBai</td>
                <td>
                    <a asp-action="DanhSachBaiNop" asp-route-id="@item.MaBaiTap" class="fw-semibold text-primary">
                        @item.TenBaiTap
                    </a>
                </td>


                <td>
                    @if (item.HanNop != null)
                    {
                        @item.HanNop?.ToString("dd/MM/yyyy HH:mm")
                    }
                    else
                    {
                        <span class="text-muted">Không có</span>
                    }
                </td>

                <td>
                    @if (item.LateSubmission != null)
                    {
                        @item.LateSubmission?.ToString("dd/MM/yyyy HH:mm")
                    }
                    else
                    {
                        <span class="text-muted">Không có</span>
                    }
                </td>

                <td>
                    <a asp-action="Details" asp-route-id="@item.MaBaiTap" class="action-icon">
                        <i class="mdi mdi-eye" style="color:#19b6ff;font-size:25px;"></i>
                    </a>

                    <a asp-action="Edit" asp-route-id="@item.MaBaiTap" class="action-icon">
                        <i class="mdi mdi-square-edit-outline" style="color:#ffd83b;font-size:25px;"></i>
                    </a>

                    <a asp-action="Delete" asp-route-id="@item.MaBaiTap" class="action-icon">
                        <i class="mdi mdi-delete" style="color:#e75555;font-size:25px;"></i>
                    </a>
                </td>
            </tr>
        }
    </tbody>
</table>

<!-- Pagination -->
<div class="row">
    <ul class="pagination justify-content-end">
        @Html.PagedListPager(Model, page => Url.Action("Index", new { page }),
                 new PagedListRenderOptions()
        {
            ActiveLiElementClass = "active",
            PageClasses = new[] { "page-link" },
            LiElementClasses = new[] { "page-item" },
            UlElementClasses = new[] { "pagination", "justify-content-center", "mt-3" },
            LinkToNextPageFormat = "Sau",
            LinkToPreviousPageFormat = "Trước",
            MaximumPageNumbersToDisplay = 3,
            DisplayLinkToPreviousPage = PagedListDisplayMode.Always,
            DisplayLinkToNextPage = PagedListDisplayMode.Always
        })
    </ul>
</div>
